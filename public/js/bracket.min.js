(function(e,t,n,r){function i(r){if(!n[r]){if(!t[r]){if(e)return e(r);throw Error("Cannot find module '"+r+"'")}var s=n[r]={exports:{}};t[r][0](function(e){var n=t[r][1][e];return i(n?n:e)},s,s.exports)}return n[r].exports}for(var s=0;r.length>s;s++)i(r[s]);return i})("undefined"!=typeof require&&require,{1:[function(require){window.Bracket={Validator:require("../node_modules/bracket-validator/lib/validator"),Generator:require("../node_modules/bracket-validator/lib/generator")}},{"../node_modules/bracket-validator/lib/validator":2,"../node_modules/bracket-validator/lib/generator":3}],4:[function(require,module){for(var startYear=2012,order=[1,16,8,9,5,12,4,13,6,11,3,14,7,10,2,15],currentYear=(new Date).getFullYear(),exportData={},i=startYear,m=currentYear;m>=i;i++)exportData[""+i]=order;module.exports=function(options){return options=options||{},exportData[options.year||currentYear]}},{}],3:[function(require,module){function Generator(options){options=options||{},this.data=options.data||thisData,this.firstRoundOrder=options.order||thisOrder,this.howToPickWinners=options.winners||"",this.generatedBracket=null,this.winnerCounter=0,this.regionCounter=0,this.finishedRegions=null}var _=require("lodash"),thisData=require("../data/ncaa-mens-basketball/data")(),thisOrder=require("../data/ncaa-mens-basketball/order")(),CONSTS=require("../data/ncaa-mens-basketball/consts");Generator.prototype.winners=function(arg){return this.generatedBracket=null,this.finishedRegions=null,this.howToPickWinners=arg,this},Generator.prototype.generateWinner=function(matchup){_.isString(matchup[0])&&_.isString(matchup[1])&&(matchup=_.map(matchup,function(region){return this.winningTeamFromRegion(region)},this));var winner,possible={random:_.random(matchup.length-1),higher:function(){return 2>_.uniq(matchup,!0).length?1:matchup.indexOf(Math.max.apply(Math,matchup))},lower:function(){return 2>_.uniq(matchup,!0).length?0:matchup.indexOf(Math.min.apply(Math,matchup))}},pickIndex=this.howToPickWinners.length>=this.firstRoundOrder.length?this.regionCounter*(this.firstRoundOrder.length-1)+(this.winnerCounter+1)-1:this.winnerCounter,pick=this.howToPickWinners.charAt(pickIndex);return"1"===pick?winner=possible.higher():"0"===pick?winner=possible.lower():"function"==typeof possible[this.howToPickWinners]?winner=possible[this.howToPickWinners]():possible[this.howToPickWinners]!==void 0&&(winner=possible[this.howToPickWinners]),winner>=0&&matchup.length>winner?winner:possible.random},Generator.prototype.generateRound=function(opts){var seeds=opts.seeds,matchup=[seeds[0],seeds[1]],winner=matchup[this.generateWinner(matchup)],winners=(opts.winners||[]).concat(winner),remainingSeeds=seeds.splice(2);return this.winnerCounter++,0===remainingSeeds.length?winners:this.generateRound({seeds:remainingSeeds,winners:winners})},Generator.prototype.generateRounds=function(opts){var optRound=_.toArray(opts.round),round=this.generateRound({seeds:opts.round}),rounds=opts.rounds||[];return 0===rounds.length&&rounds.push(optRound),rounds.push(_.toArray(round)),1===round.length?(this.regionCounter++,rounds):this.generateRounds({round:round,rounds:rounds})},Generator.prototype.generateRegion=function(region,key){return this.winnerCounter=0,{id:key,rounds:this.generateRounds({round:this.firstRoundOrder.slice()})}},Generator.prototype.generateRegions=function(){this.regionCounter=0;var regions=_.map(this.data.regions,this.generateRegion,this);return this.finishedRegions=regions,regions},Generator.prototype.generateBracket=function(){return null===this.generatedBracket&&(this.generatedBracket=this.generateRegions().concat(this.generateFinal())),this.generatedBracket},Generator.prototype.generateFinalFour=function(){var regions=_.keys(this.data.regions),firstTeam=regions[0],matchup1=[firstTeam,this.data.regions[firstTeam].sameSideAs],matchup2=_.difference(regions,matchup1);return _.flatten([matchup1,matchup2])},Generator.prototype.generateFinal=function(){return this.winnerCounter=0,{id:CONSTS.FINAL_ID,name:CONSTS.FINAL_NAME,rounds:this.generateRounds({round:this.generateFinalFour()})}},Generator.prototype.winningTeamFromRegion=function(fromRegion){var hasFinishedRegions=!!this.finishedRegions.length,regions=hasFinishedRegions?this.finishedRegions:this.generateBracket();return _.last(_.find(regions,function(region){return region.id===fromRegion}).rounds)[0]},Generator.prototype.teamNameFromRegion=function(regionName,seed){return this.data.regions[regionName].teams[seed-1]},Generator.prototype.bracketWithTeamInfo=function(){var bracket=_.toArray(this.generateBracket()),originalData=_.cloneDeep(this.data.regions);return _.each(bracket,function(region){_.has(originalData,region.id)||(originalData[region.id]=_.omit(region,"rounds")),originalData[region.id].id=region.id,originalData[region.id].rounds=_.map(region.rounds,function(round){var returnRound=[];return _.each(round,function(seed,index){returnRound[index]=region.id===CONSTS.FINAL_ID?{fromRegion:seed,seed:this.winningTeamFromRegion(seed),name:this.teamNameFromRegion(seed,this.winningTeamFromRegion(seed))}:{fromRegion:region.id,seed:seed,name:this.teamNameFromRegion(region.id,seed)}},this),returnRound},this)},this),originalData},Generator.prototype.flatBracket=function(){return _.map(_.flatten(_.toArray(this.generateBracket())),function(region){return region.id+_.flatten(region.rounds).join("")}).join("").replace(RegExp(this.firstRoundOrder.join(""),"g"),"").replace(RegExp(this.generateFinalFour().join(""),"g"),"")},module.exports=Generator},{"../data/ncaa-mens-basketball/data":5,"../data/ncaa-mens-basketball/order":4,"../data/ncaa-mens-basketball/consts":6,lodash:7}],8:[function(require,module){var thisData=(require("lodash"),require("../data/ncaa-mens-basketball/data")()),CONSTS=require("../data/ncaa-mens-basketball/consts");module.exports=function(options){options=options||{};var regionRegEx=(options.data||thisData,"([a-zA-Z]{1,2})([\\d"+CONSTS.UNPICKED_MATCH+"]{"+(CONSTS.TEAMS_PER_REGION-1)+","+2*(CONSTS.TEAMS_PER_REGION-1)+"})"),finalRegEx="("+CONSTS.FINAL_ID+")([a-zA-Z]{"+(CONSTS.REGION_COUNT-1)+","+2*(CONSTS.REGION_COUNT-1)+"})";return RegExp(Array(CONSTS.REGION_COUNT+1).join(regionRegEx)+finalRegEx)}},{"../data/ncaa-mens-basketball/data":5,"../data/ncaa-mens-basketball/consts":6,lodash:7}],7:[function(require,module,exports){(function(global){(function(window,undefined){function lodash(value){return value&&"object"==typeof value&&value.__wrapped__?value:this instanceof lodash?(this.__wrapped__=value,undefined):new lodash(value)}function cachedContains(array,fromIndex,largeSize){fromIndex||(fromIndex=0);var length=array.length,isLarge=length-fromIndex>=(largeSize||largeArraySize);if(isLarge)for(var cache={},index=fromIndex-1;length>++index;){var key=array[index]+"";(hasOwnProperty.call(cache,key)?cache[key]:cache[key]=[]).push(array[index])}return function(value){if(isLarge){var key=value+"";return hasOwnProperty.call(cache,key)&&indexOf(cache[key],value)>-1}return indexOf(array,value,fromIndex)>-1}}function charAtCallback(value){return value.charCodeAt(0)}function compareAscending(a,b){var ai=a.index,bi=b.index;if(a=a.criteria,b=b.criteria,a!==b){if(a>b||a===undefined)return 1;if(b>a||b===undefined)return-1}return bi>ai?-1:1}function createBound(func,thisArg,partialArgs,rightIndicator){function bound(){var args=arguments,thisBinding=isPartial?this:thisArg;if(isFunc||(func=thisArg[key]),partialArgs.length&&(args=args.length?(args=slice(args),rightIndicator?args.concat(partialArgs):partialArgs.concat(args)):partialArgs),this instanceof bound){noop.prototype=func.prototype,thisBinding=new noop,noop.prototype=null;var result=func.apply(thisBinding,args);return isObject(result)?result:thisBinding}return func.apply(thisBinding,args)}var isFunc=isFunction(func),isPartial=!partialArgs,key=thisArg;return isPartial&&(partialArgs=thisArg),isFunc||(thisArg=func),bound}function createCallback(func,thisArg,argCount){if(null==func)return identity;var type=typeof func;if("function"!=type){if("object"!=type)return function(object){return object[func]};var props=keys(func);return function(object){for(var length=props.length,result=!1;length--&&(result=isEqual(object[props[length]],func[props[length]],indicatorObject)););return result}}return thisArg!==undefined?1===argCount?function(value){return func.call(thisArg,value)}:2===argCount?function(a,b){return func.call(thisArg,a,b)}:4===argCount?function(accumulator,value,index,object){return func.call(thisArg,accumulator,value,index,object)}:function(value,index,object){return func.call(thisArg,value,index,object)}:func}function createIterator(){for(var object,data={isKeysFast:isKeysFast,arrays:"isArray(iterable)",bottom:"",loop:"",top:"",useHas:!0},index=0;object=arguments[index];index++)for(var key in object)data[key]=object[key];var args=data.args;data.firstArg=/^[^,]+/.exec(args)[0];var factory=Function("createCallback, hasOwnProperty, isArguments, isArray, isString, objectTypes, nativeKeys","return function("+args+") {\n"+iteratorTemplate(data)+"\n}");return factory(createCallback,hasOwnProperty,isArguments,isArray,isString,objectTypes,nativeKeys)}function escapeStringChar(match){return"\\"+stringEscapes[match]}function escapeHtmlChar(match){return htmlEscapes[match]}function noop(){}function slice(array,start,end){start||(start=0),end===undefined&&(end=array?array.length:0);for(var index=-1,length=end-start||0,result=Array(0>length?0:length);length>++index;)result[index]=array[start+index];return result}function unescapeHtmlChar(match){return htmlUnescapes[match]}function isArguments(value){return toString.call(value)==argsClass}function shimIsPlainObject(value){var result=!1;if(!value||"object"!=typeof value||isArguments(value))return result;var ctor=value.constructor;return!isFunction(ctor)||ctor instanceof ctor?(forIn(value,function(value,key){result=key}),result===!1||hasOwnProperty.call(value,result)):result}function shimKeys(object){var result=[];return forOwn(object,function(value,key){result.push(key)}),result}function clone(value,deep,callback,thisArg,stackA,stackB){var result=value;if("function"==typeof deep&&(thisArg=callback,callback=deep,deep=!1),"function"==typeof callback){callback=thisArg===undefined?callback:createCallback(callback,thisArg,1),result=callback(result);var done=result!==undefined;done||(result=value)}var isObj=isObject(result);if(isObj){var className=toString.call(result);if(!cloneableClasses[className])return result;var isArr=isArray(result)}if(!isObj||!deep)return isObj&&!done?isArr?slice(result):assign({},result):result;var ctor=ctorByClass[className];switch(className){case boolClass:case dateClass:return done?result:new ctor(+result);case numberClass:case stringClass:return done?result:new ctor(result);case regexpClass:return done?result:ctor(result.source,reFlags.exec(result))}stackA||(stackA=[]),stackB||(stackB=[]);for(var length=stackA.length;length--;)if(stackA[length]==value)return stackB[length];return done||(result=isArr?ctor(result.length):{},isArr&&(hasOwnProperty.call(value,"index")&&(result.index=value.index),hasOwnProperty.call(value,"input")&&(result.input=value.input))),stackA.push(value),stackB.push(result),(isArr?forEach:forOwn)(done?result:value,function(objValue,key){result[key]=clone(objValue,deep,callback,undefined,stackA,stackB)}),result}function cloneDeep(value,callback,thisArg){return clone(value,!0,callback,thisArg)}function functions(object){var result=[];return forIn(object,function(value,key){isFunction(value)&&result.push(key)}),result.sort()}function has(object,property){return object?hasOwnProperty.call(object,property):!1}function invert(object){for(var index=-1,props=keys(object),length=props.length,result={};length>++index;){var key=props[index];result[object[key]]=key}return result}function isBoolean(value){return value===!0||value===!1||toString.call(value)==boolClass}function isDate(value){return value instanceof Date||toString.call(value)==dateClass}function isElement(value){return value?1===value.nodeType:!1}function isEmpty(value){var result=!0;if(!value)return result;var className=toString.call(value),length=value.length;return className==arrayClass||className==stringClass||className==argsClass||className==objectClass&&"number"==typeof length&&isFunction(value.splice)?!length:(forOwn(value,function(){return result=!1}),result)}function isEqual(a,b,callback,thisArg,stackA,stackB){var whereIndicator=callback===indicatorObject;if(callback&&!whereIndicator){callback=thisArg===undefined?callback:createCallback(callback,thisArg,2);var result=callback(a,b);if(result!==undefined)return!!result}if(a===b)return 0!==a||1/a==1/b;var type=typeof a,otherType=typeof b;if(a===a&&(!a||"function"!=type&&"object"!=type)&&(!b||"function"!=otherType&&"object"!=otherType))return!1;if(null==a||null==b)return a===b;var className=toString.call(a),otherClass=toString.call(b);if(className==argsClass&&(className=objectClass),otherClass==argsClass&&(otherClass=objectClass),className!=otherClass)return!1;switch(className){case boolClass:case dateClass:return+a==+b;case numberClass:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case regexpClass:case stringClass:return a==b+""}var isArr=className==arrayClass;if(!isArr){if(a.__wrapped__||b.__wrapped__)return isEqual(a.__wrapped__||a,b.__wrapped__||b,callback,thisArg,stackA,stackB);if(className!=objectClass)return!1;var ctorA=a.constructor,ctorB=b.constructor;if(ctorA!=ctorB&&!(isFunction(ctorA)&&ctorA instanceof ctorA&&isFunction(ctorB)&&ctorB instanceof ctorB))return!1}stackA||(stackA=[]),stackB||(stackB=[]);for(var length=stackA.length;length--;)if(stackA[length]==a)return stackB[length]==b;var size=0;if(result=!0,stackA.push(a),stackB.push(b),isArr){if(length=a.length,size=b.length,result=size==a.length,!result&&!whereIndicator)return result;for(;size--;){var index=length,value=b[size];if(whereIndicator)for(;index--&&!(result=isEqual(a[index],value,callback,thisArg,stackA,stackB)););else if(!(result=isEqual(a[size],value,callback,thisArg,stackA,stackB)))break}return result}return forIn(b,function(value,key,b){return hasOwnProperty.call(b,key)?(size++,result=hasOwnProperty.call(a,key)&&isEqual(a[key],value,callback,thisArg,stackA,stackB)):undefined}),result&&!whereIndicator&&forIn(a,function(value,key,a){return hasOwnProperty.call(a,key)?result=--size>-1:undefined}),result}function isFinite(value){return nativeIsFinite(value)&&!nativeIsNaN(parseFloat(value))}function isFunction(value){return"function"==typeof value}function isObject(value){return value?objectTypes[typeof value]:!1}function isNaN(value){return isNumber(value)&&value!=+value}function isNull(value){return null===value}function isNumber(value){return"number"==typeof value||toString.call(value)==numberClass}function isRegExp(value){return value instanceof RegExp||toString.call(value)==regexpClass}function isString(value){return"string"==typeof value||toString.call(value)==stringClass}function isUndefined(value){return value===undefined}function merge(object,source,deepIndicator){var args=arguments,index=0,length=2;if(!isObject(object))return object;if(deepIndicator===indicatorObject)var callback=args[3],stackA=args[4],stackB=args[5];else stackA=[],stackB=[],"number"!=typeof deepIndicator&&(length=args.length),length>3&&"function"==typeof args[length-2]?callback=createCallback(args[--length-1],args[length--],2):length>2&&"function"==typeof args[length-1]&&(callback=args[--length]);for(;length>++index;)(isArray(args[index])?forEach:forOwn)(args[index],function(source,key){var found,isArr,result=source,value=object[key];if(source&&((isArr=isArray(source))||isPlainObject(source))){for(var stackLength=stackA.length;stackLength--;)if(found=stackA[stackLength]==source){value=stackB[stackLength];break}found||(value=isArr?isArray(value)?value:[]:isPlainObject(value)?value:{},callback&&(result=callback(value,source),result!==undefined&&(value=result)),stackA.push(source),stackB.push(value),callback||(value=merge(value,source,indicatorObject,callback,stackA,stackB)))}else callback&&(result=callback(value,source),result===undefined&&(result=source)),result!==undefined&&(value=result);object[key]=value});return object}function omit(object,callback,thisArg){var isFunc="function"==typeof callback,result={};if(isFunc)callback=createCallback(callback,thisArg);else var props=concat.apply(arrayRef,arguments);return forIn(object,function(value,key,object){(isFunc?!callback(value,key,object):0>indexOf(props,key,1))&&(result[key]=value)}),result}function pairs(object){for(var index=-1,props=keys(object),length=props.length,result=Array(length);length>++index;){var key=props[index];result[index]=[key,object[key]]}return result}function pick(object,callback,thisArg){var result={};if("function"!=typeof callback)for(var index=0,props=concat.apply(arrayRef,arguments),length=isObject(object)?props.length:0;length>++index;){var key=props[index];key in object&&(result[key]=object[key])}else callback=createCallback(callback,thisArg),forIn(object,function(value,key,object){callback(value,key,object)&&(result[key]=value)});return result}function values(object){for(var index=-1,props=keys(object),length=props.length,result=Array(length);length>++index;)result[index]=object[props[index]];return result}function at(collection){for(var index=-1,props=concat.apply(arrayRef,slice(arguments,1)),length=props.length,result=Array(length);length>++index;)result[index]=collection[props[index]];return result}function contains(collection,target,fromIndex){var index=-1,length=collection?collection.length:0,result=!1;return fromIndex=(0>fromIndex?nativeMax(0,length+fromIndex):fromIndex)||0,"number"==typeof length?result=(isString(collection)?collection.indexOf(target,fromIndex):indexOf(collection,target,fromIndex))>-1:each(collection,function(value){return++index>=fromIndex?!(result=value===target):undefined}),result}function countBy(collection,callback,thisArg){var result={};return callback=createCallback(callback,thisArg),forEach(collection,function(value,key,collection){key=callback(value,key,collection)+"",hasOwnProperty.call(result,key)?result[key]++:result[key]=1}),result}function every(collection,callback,thisArg){var result=!0;if(callback=createCallback(callback,thisArg),isArray(collection))for(var index=-1,length=collection.length;length>++index&&(result=!!callback(collection[index],index,collection)););else each(collection,function(value,index,collection){return result=!!callback(value,index,collection)});return result}function filter(collection,callback,thisArg){var result=[];if(callback=createCallback(callback,thisArg),isArray(collection))for(var index=-1,length=collection.length;length>++index;){var value=collection[index];callback(value,index,collection)&&result.push(value)}else each(collection,function(value,index,collection){callback(value,index,collection)&&result.push(value)});return result}function find(collection,callback,thisArg){var result;return callback=createCallback(callback,thisArg),forEach(collection,function(value,index,collection){return callback(value,index,collection)?(result=value,!1):undefined}),result}function forEach(collection,callback,thisArg){if(callback&&thisArg===undefined&&isArray(collection))for(var index=-1,length=collection.length;length>++index&&callback(collection[index],index,collection)!==!1;);else each(collection,callback,thisArg);return collection}function groupBy(collection,callback,thisArg){var result={};return callback=createCallback(callback,thisArg),forEach(collection,function(value,key,collection){key=callback(value,key,collection)+"",(hasOwnProperty.call(result,key)?result[key]:result[key]=[]).push(value)}),result}function invoke(collection,methodName){var args=slice(arguments,2),index=-1,isFunc="function"==typeof methodName,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);return forEach(collection,function(value){result[++index]=(isFunc?methodName:value[methodName]).apply(value,args)}),result}function map(collection,callback,thisArg){var index=-1,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);if(callback=createCallback(callback,thisArg),isArray(collection))for(;length>++index;)result[index]=callback(collection[index],index,collection);else each(collection,function(value,key,collection){result[++index]=callback(value,key,collection)});return result}function max(collection,callback,thisArg){var computed=-1/0,result=computed;if(!callback&&isArray(collection))for(var index=-1,length=collection.length;length>++index;){var value=collection[index];value>result&&(result=value)}else callback=!callback&&isString(collection)?charAtCallback:createCallback(callback,thisArg),each(collection,function(value,index,collection){var current=callback(value,index,collection);current>computed&&(computed=current,result=value)});return result}function min(collection,callback,thisArg){var computed=1/0,result=computed;if(!callback&&isArray(collection))for(var index=-1,length=collection.length;length>++index;){var value=collection[index];result>value&&(result=value)}else callback=!callback&&isString(collection)?charAtCallback:createCallback(callback,thisArg),each(collection,function(value,index,collection){var current=callback(value,index,collection);computed>current&&(computed=current,result=value)});return result}function reduce(collection,callback,accumulator,thisArg){var noaccum=3>arguments.length;if(callback=createCallback(callback,thisArg,4),isArray(collection)){var index=-1,length=collection.length;for(noaccum&&(accumulator=collection[++index]);length>++index;)accumulator=callback(accumulator,collection[index],index,collection)}else each(collection,function(value,index,collection){accumulator=noaccum?(noaccum=!1,value):callback(accumulator,value,index,collection)});return accumulator}function reduceRight(collection,callback,accumulator,thisArg){var iterable=collection,length=collection?collection.length:0,noaccum=3>arguments.length;if("number"!=typeof length){var props=keys(collection);length=props.length}return callback=createCallback(callback,thisArg,4),forEach(collection,function(value,index,collection){index=props?props[--length]:--length,accumulator=noaccum?(noaccum=!1,iterable[index]):callback(accumulator,iterable[index],index,collection)}),accumulator}function reject(collection,callback,thisArg){return callback=createCallback(callback,thisArg),filter(collection,function(value,index,collection){return!callback(value,index,collection)})}function shuffle(collection){var index=-1,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);return forEach(collection,function(value){var rand=floor(nativeRandom()*(++index+1));result[index]=result[rand],result[rand]=value}),result}function size(collection){var length=collection?collection.length:0;return"number"==typeof length?length:keys(collection).length}function some(collection,callback,thisArg){var result;if(callback=createCallback(callback,thisArg),isArray(collection))for(var index=-1,length=collection.length;length>++index&&!(result=callback(collection[index],index,collection)););else each(collection,function(value,index,collection){return!(result=callback(value,index,collection))});return!!result}function sortBy(collection,callback,thisArg){var index=-1,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);for(callback=createCallback(callback,thisArg),forEach(collection,function(value,key,collection){result[++index]={criteria:callback(value,key,collection),index:index,value:value}}),length=result.length,result.sort(compareAscending);length--;)result[length]=result[length].value;return result}function toArray(collection){return collection&&"number"==typeof collection.length?slice(collection):values(collection)}function compact(array){for(var index=-1,length=array?array.length:0,result=[];length>++index;){var value=array[index];value&&result.push(value)}return result}function difference(array){for(var index=-1,length=array?array.length:0,flattened=concat.apply(arrayRef,arguments),contains=cachedContains(flattened,length),result=[];length>++index;){var value=array[index];contains(value)||result.push(value)}return result}function first(array,callback,thisArg){if(array){var n=0,length=array.length;if("number"!=typeof callback&&null!=callback){var index=-1;for(callback=createCallback(callback,thisArg);length>++index&&callback(array[index],index,array);)n++}else if(n=callback,null==n||thisArg)return array[0];return slice(array,0,nativeMin(nativeMax(0,n),length))}}function flatten(array,shallow){for(var index=-1,length=array?array.length:0,result=[];length>++index;){var value=array[index];isArray(value)?push.apply(result,shallow?value:flatten(value)):result.push(value)}return result}function indexOf(array,value,fromIndex){var index=-1,length=array?array.length:0;if("number"==typeof fromIndex)index=(0>fromIndex?nativeMax(0,length+fromIndex):fromIndex||0)-1;else if(fromIndex)return index=sortedIndex(array,value),array[index]===value?index:-1;for(;length>++index;)if(array[index]===value)return index;return-1}function initial(array,callback,thisArg){if(!array)return[];var n=0,length=array.length;if("number"!=typeof callback&&null!=callback){var index=length;for(callback=createCallback(callback,thisArg);index--&&callback(array[index],index,array);)n++}else n=null==callback||thisArg?1:callback||n;return slice(array,0,nativeMin(nativeMax(0,length-n),length))}function intersection(array){var args=arguments,argsLength=args.length,cache={0:{}},index=-1,length=array?array.length:0,isLarge=length>=100,result=[],seen=result;outer:for(;length>++index;){var value=array[index];if(isLarge)var key=value+"",inited=hasOwnProperty.call(cache[0],key)?!(seen=cache[0][key]):seen=cache[0][key]=[];if(inited||0>indexOf(seen,value)){isLarge&&seen.push(value);for(var argsIndex=argsLength;--argsIndex;)if(!(cache[argsIndex]||(cache[argsIndex]=cachedContains(args[argsIndex],0,100)))(value))continue outer;result.push(value)}}return result}function last(array,callback,thisArg){if(array){var n=0,length=array.length;if("number"!=typeof callback&&null!=callback){var index=length;for(callback=createCallback(callback,thisArg);index--&&callback(array[index],index,array);)n++}else if(n=callback,null==n||thisArg)return array[length-1];return slice(array,nativeMax(0,length-n))}}function lastIndexOf(array,value,fromIndex){var index=array?array.length:0;for("number"==typeof fromIndex&&(index=(0>fromIndex?nativeMax(0,index+fromIndex):nativeMin(fromIndex,index-1))+1);index--;)if(array[index]===value)return index;return-1}function object(keys,values){for(var index=-1,length=keys?keys.length:0,result={};length>++index;){var key=keys[index];values?result[key]=values[index]:result[key[0]]=key[1]}return result}function range(start,end,step){start=+start||0,step=+step||1,null==end&&(end=start,start=0);for(var index=-1,length=nativeMax(0,ceil((end-start)/step)),result=Array(length);length>++index;)result[index]=start,start+=step;return result}function rest(array,callback,thisArg){if("number"!=typeof callback&&null!=callback){var n=0,index=-1,length=array?array.length:0;for(callback=createCallback(callback,thisArg);length>++index&&callback(array[index],index,array);)n++}else n=null==callback||thisArg?1:nativeMax(0,callback);return slice(array,n)}function sortedIndex(array,value,callback,thisArg){var low=0,high=array?array.length:low;for(callback=callback?createCallback(callback,thisArg,1):identity,value=callback(value);high>low;){var mid=low+high>>>1;value>callback(array[mid])?low=mid+1:high=mid}return low}function union(){return uniq(concat.apply(arrayRef,arguments))}function uniq(array,isSorted,callback,thisArg){var index=-1,length=array?array.length:0,result=[],seen=result;"function"==typeof isSorted&&(thisArg=callback,callback=isSorted,isSorted=!1);var isLarge=!isSorted&&length>=75;if(isLarge)var cache={};for(callback&&(seen=[],callback=createCallback(callback,thisArg));length>++index;){var value=array[index],computed=callback?callback(value,index,array):value;if(isLarge)var key=computed+"",inited=hasOwnProperty.call(cache,key)?!(seen=cache[key]):seen=cache[key]=[];(isSorted?!index||seen[seen.length-1]!==computed:inited||0>indexOf(seen,computed))&&((callback||isLarge)&&seen.push(computed),result.push(value))}return result}function without(array){for(var index=-1,length=array?array.length:0,contains=cachedContains(arguments,1),result=[];length>++index;){var value=array[index];contains(value)||result.push(value)}return result}function zip(array){for(var index=-1,length=array?max(pluck(arguments,"length")):0,result=Array(length);length>++index;)result[index]=pluck(arguments,index);return result}function after(n,func){return 1>n?func():function(){return 1>--n?func.apply(this,arguments):undefined}}function bind(func,thisArg){return isBindFast||nativeBind&&arguments.length>2?nativeBind.call.apply(nativeBind,arguments):createBound(func,thisArg,slice(arguments,2))}function bindAll(object){for(var funcs=concat.apply(arrayRef,arguments),index=funcs.length>1?0:(funcs=functions(object),-1),length=funcs.length;length>++index;){var key=funcs[index];object[key]=bind(object[key],object)}return object}function bindKey(object,key){return createBound(object,key,slice(arguments,2))}function compose(){var funcs=arguments;return function(){for(var args=arguments,length=funcs.length;length--;)args=[funcs[length].apply(this,args)];return args[0]}}function debounce(func,wait,immediate){function delayed(){timeoutId=null,immediate||(result=func.apply(thisArg,args))}var args,result,thisArg,timeoutId;return function(){var isImmediate=immediate&&!timeoutId;return args=arguments,thisArg=this,clearTimeout(timeoutId),timeoutId=setTimeout(delayed,wait),isImmediate&&(result=func.apply(thisArg,args)),result}}function delay(func,wait){var args=slice(arguments,2);return setTimeout(function(){func.apply(undefined,args)},wait)}function defer(func){var args=slice(arguments,1);return setTimeout(function(){func.apply(undefined,args)},1)}function memoize(func,resolver){var cache={};return function(){var key=(resolver?resolver.apply(this,arguments):arguments[0])+"";return hasOwnProperty.call(cache,key)?cache[key]:cache[key]=func.apply(this,arguments)}}function once(func){var ran,result;return function(){return ran?result:(ran=!0,result=func.apply(this,arguments),func=null,result)}}function partial(func){return createBound(func,slice(arguments,1))}function partialRight(func){return createBound(func,slice(arguments,1),null,indicatorObject)}function throttle(func,wait){function trailingCall(){lastCalled=new Date,timeoutId=null,result=func.apply(thisArg,args)}var args,result,thisArg,timeoutId,lastCalled=0;return function(){var now=new Date,remaining=wait-(now-lastCalled);return args=arguments,thisArg=this,0>=remaining?(clearTimeout(timeoutId),timeoutId=null,lastCalled=now,result=func.apply(thisArg,args)):timeoutId||(timeoutId=setTimeout(trailingCall,remaining)),result}}function wrap(value,wrapper){return function(){var args=[value];return push.apply(args,arguments),wrapper.apply(this,args)}}function escape(string){return null==string?"":(string+"").replace(reUnescapedHtml,escapeHtmlChar)}function identity(value){return value}function mixin(object){forEach(functions(object),function(methodName){var func=lodash[methodName]=object[methodName];lodash.prototype[methodName]=function(){var args=[this.__wrapped__];return push.apply(args,arguments),new lodash(func.apply(lodash,args))}})}function noConflict(){return window._=oldDash,this}function random(min,max){return null==min&&null==max&&(max=1),min=+min||0,null==max&&(max=min,min=0),min+floor(nativeRandom()*((+max||0)-min+1))}function result(object,property){var value=object?object[property]:undefined;return isFunction(value)?object[property]():value}function template(text,data,options){var settings=lodash.templateSettings;text||(text=""),options=defaults({},options,settings);var isEvaluating,imports=defaults({},options.imports,settings.imports),importsKeys=keys(imports),importsValues=values(imports),index=0,interpolate=options.interpolate||reNoMatch,source="__p += '",reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g");
text.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){return interpolateValue||(interpolateValue=esTemplateValue),source+=text.slice(index,offset).replace(reUnescapedString,escapeStringChar),escapeValue&&(source+="' +\n__e("+escapeValue+") +\n'"),evaluateValue&&(isEvaluating=!0,source+="';\n"+evaluateValue+";\n__p += '"),interpolateValue&&(source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"),index=offset+match.length,match}),source+="';\n";var variable=options.variable,hasVariable=variable;hasVariable||(variable="obj",source="with ("+variable+") {\n"+source+"\n}\n"),source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),source="function("+variable+") {\n"+(hasVariable?"":variable+" || ("+variable+" = {});\n")+"var __t, __p = '', __e = _.escape"+(isEvaluating?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var sourceURL="\n/*\n//@ sourceURL="+(options.sourceURL||"/lodash/template/source["+templateCounter++ +"]")+"\n*/";try{var result=Function(importsKeys,"return "+source+sourceURL).apply(undefined,importsValues)}catch(e){throw e.source=source,e}return data?result(data):(result.source=source,result)}function times(n,callback,thisArg){n=+n||0;for(var index=-1,result=Array(n);n>++index;)result[index]=callback.call(thisArg,index);return result}function unescape(string){return null==string?"":(string+"").replace(reEscapedHtml,unescapeHtmlChar)}function uniqueId(prefix){var id=++idCounter;return(null==prefix?"":prefix+"")+id}function tap(value,interceptor){return interceptor(value),value}function wrapperToString(){return this.__wrapped__+""}function wrapperValueOf(){return this.__wrapped__}var freeExports="object"==typeof exports&&exports,freeModule="object"==typeof module&&module&&module.exports==freeExports&&module,freeGlobal="object"==typeof global&&global;freeGlobal.global===freeGlobal&&(window=freeGlobal);var arrayRef=[],objectRef={},idCounter=0,indicatorObject=objectRef,largeArraySize=30,oldDash=window._,reEscapedHtml=/&(?:amp|lt|gt|quot|#39);/g,reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reFlags=/\w*$/,reNative=RegExp("^"+(objectRef.valueOf+"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reInterpolate=/<%=([\s\S]+?)%>/g,reNoMatch=/($^)/,reUnescapedHtml=/[&<>"']/g,reUnescapedString=/['\n\r\t\u2028\u2029\\]/g,templateCounter=0,ceil=Math.ceil,concat=arrayRef.concat,floor=Math.floor,getPrototypeOf=reNative.test(getPrototypeOf=Object.getPrototypeOf)&&getPrototypeOf,hasOwnProperty=objectRef.hasOwnProperty,push=arrayRef.push,toString=objectRef.toString,nativeBind=reNative.test(nativeBind=slice.bind)&&nativeBind,nativeIsArray=reNative.test(nativeIsArray=Array.isArray)&&nativeIsArray,nativeIsFinite=window.isFinite,nativeIsNaN=window.isNaN,nativeKeys=reNative.test(nativeKeys=Object.keys)&&nativeKeys,nativeMax=Math.max,nativeMin=Math.min,nativeRandom=Math.random,argsClass="[object Arguments]",arrayClass="[object Array]",boolClass="[object Boolean]",dateClass="[object Date]",funcClass="[object Function]",numberClass="[object Number]",objectClass="[object Object]",regexpClass="[object RegExp]",stringClass="[object String]",isIeOpera=!!window.attachEvent,isV8=nativeBind&&!/\n|true/.test(nativeBind+isIeOpera),isBindFast=nativeBind&&!isV8,isKeysFast=nativeKeys&&(isIeOpera||isV8),cloneableClasses={};cloneableClasses[funcClass]=!1,cloneableClasses[argsClass]=cloneableClasses[arrayClass]=cloneableClasses[boolClass]=cloneableClasses[dateClass]=cloneableClasses[numberClass]=cloneableClasses[objectClass]=cloneableClasses[regexpClass]=cloneableClasses[stringClass]=!0;var ctorByClass={};ctorByClass[arrayClass]=Array,ctorByClass[boolClass]=Boolean,ctorByClass[dateClass]=Date,ctorByClass[objectClass]=Object,ctorByClass[numberClass]=Number,ctorByClass[regexpClass]=RegExp,ctorByClass[stringClass]=String;var objectTypes={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};lodash.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:reInterpolate,variable:"",imports:{_:lodash}};var iteratorTemplate=function(obj){var __p="var index, iterable = "+obj.firstArg+", result = iterable;\nif (!iterable) return result;\n"+obj.top+";\n";return obj.arrays&&(__p+="var length = iterable.length; index = -1;\nif ("+obj.arrays+") {\n  while (++index < length) {\n    "+obj.loop+"\n  }\n}\nelse {  "),obj.isKeysFast&&obj.useHas?__p+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] ? nativeKeys(iterable) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    "+obj.loop+"\n  }  ":(__p+="\n  for (index in iterable) {",obj.useHas&&(__p+="\n    if (",obj.useHas&&(__p+="hasOwnProperty.call(iterable, index)"),__p+=") {    "),__p+=obj.loop+";    ",obj.useHas&&(__p+="\n    }"),__p+="\n  }  "),obj.arrays&&(__p+="\n}"),__p+=obj.bottom+";\nreturn result"},defaultsIteratorOptions={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},eachIteratorOptions={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : createCallback(callback, thisArg)",arrays:"typeof length == 'number'",loop:"if (callback(iterable[index], index, collection) === false) return result"},forOwnIteratorOptions={top:"if (!objectTypes[typeof iterable]) return result;\n"+eachIteratorOptions.top,arrays:!1},each=createIterator(eachIteratorOptions),forIn=createIterator(eachIteratorOptions,forOwnIteratorOptions,{useHas:!1}),forOwn=createIterator(eachIteratorOptions,forOwnIteratorOptions),isArray=nativeIsArray||function(value){return value instanceof Array||toString.call(value)==arrayClass},keys=nativeKeys?function(object){return isObject(object)?nativeKeys(object):[]}:shimKeys,htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},htmlUnescapes=invert(htmlEscapes),assign=createIterator(defaultsIteratorOptions,{top:defaultsIteratorOptions.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = createCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),defaults=createIterator(defaultsIteratorOptions);isFunction(/x/)&&(isFunction=function(value){return value instanceof Function||toString.call(value)==funcClass});var isPlainObject=function(value){if(!value||"object"!=typeof value)return!1;var valueOf=value.valueOf,objProto="function"==typeof valueOf&&(objProto=getPrototypeOf(valueOf))&&getPrototypeOf(objProto);return objProto?value==objProto||getPrototypeOf(value)==objProto&&!isArguments(value):shimIsPlainObject(value)},pluck=map,where=filter;isV8&&freeModule&&"function"==typeof setImmediate&&(defer=bind(setImmediate,window)),lodash.after=after,lodash.assign=assign,lodash.at=at,lodash.bind=bind,lodash.bindAll=bindAll,lodash.bindKey=bindKey,lodash.compact=compact,lodash.compose=compose,lodash.countBy=countBy,lodash.debounce=debounce,lodash.defaults=defaults,lodash.defer=defer,lodash.delay=delay,lodash.difference=difference,lodash.filter=filter,lodash.flatten=flatten,lodash.forEach=forEach,lodash.forIn=forIn,lodash.forOwn=forOwn,lodash.functions=functions,lodash.groupBy=groupBy,lodash.initial=initial,lodash.intersection=intersection,lodash.invert=invert,lodash.invoke=invoke,lodash.keys=keys,lodash.map=map,lodash.max=max,lodash.memoize=memoize,lodash.merge=merge,lodash.min=min,lodash.object=object,lodash.omit=omit,lodash.once=once,lodash.pairs=pairs,lodash.partial=partial,lodash.partialRight=partialRight,lodash.pick=pick,lodash.pluck=pluck,lodash.range=range,lodash.reject=reject,lodash.rest=rest,lodash.shuffle=shuffle,lodash.sortBy=sortBy,lodash.tap=tap,lodash.throttle=throttle,lodash.times=times,lodash.toArray=toArray,lodash.union=union,lodash.uniq=uniq,lodash.values=values,lodash.where=where,lodash.without=without,lodash.wrap=wrap,lodash.zip=zip,lodash.collect=map,lodash.drop=rest,lodash.each=forEach,lodash.extend=assign,lodash.methods=functions,lodash.select=filter,lodash.tail=rest,lodash.unique=uniq,mixin(lodash),lodash.clone=clone,lodash.cloneDeep=cloneDeep,lodash.contains=contains,lodash.escape=escape,lodash.every=every,lodash.find=find,lodash.has=has,lodash.identity=identity,lodash.indexOf=indexOf,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isBoolean=isBoolean,lodash.isDate=isDate,lodash.isElement=isElement,lodash.isEmpty=isEmpty,lodash.isEqual=isEqual,lodash.isFinite=isFinite,lodash.isFunction=isFunction,lodash.isNaN=isNaN,lodash.isNull=isNull,lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isPlainObject=isPlainObject,lodash.isRegExp=isRegExp,lodash.isString=isString,lodash.isUndefined=isUndefined,lodash.lastIndexOf=lastIndexOf,lodash.mixin=mixin,lodash.noConflict=noConflict,lodash.random=random,lodash.reduce=reduce,lodash.reduceRight=reduceRight,lodash.result=result,lodash.size=size,lodash.some=some,lodash.sortedIndex=sortedIndex,lodash.template=template,lodash.unescape=unescape,lodash.uniqueId=uniqueId,lodash.all=every,lodash.any=some,lodash.detect=find,lodash.foldl=reduce,lodash.foldr=reduceRight,lodash.include=contains,lodash.inject=reduce,forOwn(lodash,function(func,methodName){lodash.prototype[methodName]||(lodash.prototype[methodName]=function(){var args=[this.__wrapped__];return push.apply(args,arguments),func.apply(lodash,args)})}),lodash.first=first,lodash.last=last,lodash.take=first,lodash.head=first,forOwn(lodash,function(func,methodName){lodash.prototype[methodName]||(lodash.prototype[methodName]=function(callback,thisArg){var result=func(this.__wrapped__,callback,thisArg);return null==callback||thisArg&&"function"!=typeof callback?result:new lodash(result)})}),lodash.VERSION="1.0.1",lodash.prototype.toString=wrapperToString,lodash.prototype.value=wrapperValueOf,lodash.prototype.valueOf=wrapperValueOf,each(["join","pop","shift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return func.apply(this.__wrapped__,arguments)}}),each(["push","reverse","sort","unshift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return func.apply(this.__wrapped__,arguments),this}}),each(["concat","slice","splice"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return new lodash(func.apply(this.__wrapped__,arguments))}}),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(window._=lodash,define(function(){return lodash})):freeExports?freeModule?(freeModule.exports=lodash)._=lodash:freeExports._=lodash:window._=lodash})(this)})(window)},{}],2:[function(require,module){function Validator(options){options=options||{},this.data=options.data||thisData,this.bracketChecks={},this.bracketErrors=[],this.firstRoundOrder=options.order||thisOrder,this.testOnly=options.testOnly||!1,this.allRegions=CONSTS.REGION_IDS.concat(CONSTS.FINAL_ID);var emptyBracket=this.allRegions.join(Array(CONSTS.TEAMS_PER_REGION).join(CONSTS.UNPICKED_MATCH))+Array(CONSTS.REGION_COUNT).join(CONSTS.UNPICKED_MATCH);this.flatBracket=(options.flatBracket||(options.notEmpty?"":emptyBracket)).toUpperCase()}var _=require("lodash"),async=require("async"),thisData=require("../data/ncaa-mens-basketball/data")(),thisOrder=require("../data/ncaa-mens-basketball/order")(),CONSTS=require("../data/ncaa-mens-basketball/consts"),quickCheck=require("./quickCheck")();_.mixin({subset:function(small,big){return 0===small.length?!0:_.all(small,function(n){return _.include(big,n)})}}),_.mixin({equal:function(arr1,arr2){return arr1.length===arr2.length&&_.subset(arr1,arr2)&&_.subset(arr2,arr1)}}),Validator.prototype.wrapError=function(){return{status:!1,result:Error(_.map(_.toArray(arguments),function(arg){return"string"==typeof arg.message?arg.message:""+arg}).join(" "))}},Validator.prototype.wrapSuccess=function(result){return{status:!0,result:result||null}},Validator.prototype.expandFlatBracket=function(flat){var length=quickCheck.source.split("(").length,range=_.range(1,length),replacer=_.map(range,function(i){var prepend=1===i?'{"$':"",append=i%2?'":"$':length-1>i?'","$':'"}';return prepend+i+append}).join("");try{return this.wrapSuccess(JSON.parse(flat.replace(quickCheck,replacer)))}catch(e){return this.wrapError("Bracket does not look like a bracket:",e)}},Validator.prototype.hasNecessaryKeys=function(obj){var hasKeys=_.keys(obj),hasAllKeys=!(this.allRegions.length!==hasKeys.length||0!==_.difference(this.allRegions,hasKeys).length);return hasAllKeys?this.wrapSuccess():this.wrapError("Bracket does not have the corret keys. Missing:",_.difference(this.allRegions,hasKeys).join(","))},Validator.prototype.validate=function(callback){var self=this,findErrors=function(res){return!res.status},findSuccesses=function(res){return res.status};async.waterfall([function(cb){var result=self.expandFlatBracket(self.flatBracket);cb(result.status?null:result.result,result.status?result.result:null)},function(bracket,cb){var result=self.hasNecessaryKeys(bracket);cb(result.status?null:result.result,result.status?bracket:null)},function(bracket,cb){var result=_.map(bracket,self.picksToArray,self),errors=_.filter(result,findErrors),success=_.filter(result,findSuccesses);cb(errors.length?_.pluck(errors,"result"):null,success.length&&!errors.length?_.pluck(success,"result"):null)},function(picks,cb){var result=_.map(picks,self.getRounds,self),errors=_.filter(result,findErrors),success=_.filter(result,findSuccesses);cb(errors.length?errors:null,success.length&&!errors.length?_.pluck(success,"result"):null)},function(rounds,cb){var result=_.map(rounds,self.validatePicks,self),errors=_.filter(result,findErrors),success=_.filter(result,findSuccesses);cb(errors.length?errors:null,success.length&&!errors.length?_.pluck(success,"result"):null)},function(validatedRounds,cb){var finalRegion=_.find(validatedRounds,function(item){return item.id===CONSTS.FINAL_ID}),result=self.validateFinal(finalRegion,validatedRounds);cb(result.status?null:result.result,result.status?validatedRounds:null)},function(validatedRounds,cb){var result=self.decorateValidated(validatedRounds);cb(result.status?null:result.result,result.status?self.testOnly?self.flatBracket:result.result:null)}],function(err,res){callback(_.isArray(err)?_.flatten(err)[0]:err,res)})},Validator.prototype.decorateValidated=function(bracket){var originalData=_.cloneDeep(this.data),decorated={};return _.each(bracket,function(region){decorated[region.id]=_.extend({},region,originalData.regions[region.id]||originalData[CONSTS.FINAL_ID]),decorated[region.id].rounds=_.map(region.rounds,function(round){var returnRound=[];return _.each(round,function(seed,index){if(seed===CONSTS.UNPICKED_MATCH)returnRound[index]=null;else if(region.id===CONSTS.FINAL_ID){var winningTeam=this.winningTeamFromRegion(bracket,seed);returnRound[index]=winningTeam===CONSTS.UNPICKED_MATCH?null:{fromRegion:seed,seed:winningTeam,name:this.teamNameFromRegion(seed,winningTeam)}}else returnRound[index]={fromRegion:region.id,seed:seed,name:this.teamNameFromRegion(region.id,seed)}},this),returnRound},this)},this),this.wrapSuccess(decorated)},Validator.prototype.winningTeamFromRegion=function(bracket,regionName){return _.last(_.find(bracket,function(b){return b.id===regionName}).rounds)[0]},Validator.prototype.teamNameFromRegion=function(regionName,seed){return this.data.regions[regionName].teams[seed-1]},Validator.prototype.validatePicks=function(options){options=options||{};var rounds=options.rounds||[],regionName=options.id,length=rounds.length,regionPicks={},errors=[];return _.each(rounds,function(round,i){var requiredLength=Math.pow(2,length-1)/Math.pow(2,i),nextRound=rounds[i+1],correctLength=round.length===requiredLength,lastItem=i===length-1,thisRoundPickedGames=_.without(round,CONSTS.UNPICKED_MATCH),nextRoundPickedGames=nextRound?_.without(nextRound,CONSTS.UNPICKED_MATCH):[],nextRoundIsSubset=!lastItem&&_.subset(nextRoundPickedGames,thisRoundPickedGames);this.data.regions[regionName]||this.data[regionName],correctLength&&(lastItem||nextRoundIsSubset)?(regionPicks.id=options.id,regionPicks.rounds=rounds):correctLength?nextRoundIsSubset||errors.push("Round is not a subset of previous:",regionName,i+2):errors.push("Incorrect number of pick in:",regionName,i+1)},this),errors.length?this.wrapError.apply(this,errors):this.wrapSuccess(regionPicks)},Validator.prototype.getRounds=function(options){options=options||{};for(var rounds=options.picks||[],regionName=options.id||"",length=rounds.length+1,retRounds=[regionName===CONSTS.FINAL_ID?CONSTS.REGION_IDS:this.firstRoundOrder],verify=function(arr,keep){return _.compact(_.uniq(arr,!1,function(n){return _.indexOf(keep,n)>-1?n+Math.random():n}))},checkVal=function(val){var num=parseInt(val,10);return num>=1&&CONSTS.TEAMS_PER_REGION>=num?num:val===CONSTS.UNPICKED_MATCH?val:_.include(CONSTS.REGION_IDS,val)?val:0},count=retRounds.length;length>1;){length/=2;var roundGames=verify(_.map(rounds.splice(0,Math.floor(length)),checkVal,this),[CONSTS.UNPICKED_MATCH]);retRounds.push(roundGames),count++}return retRounds.length?this.wrapSuccess({rounds:retRounds,id:regionName}):this.wrapError("Could not get rounds from:",regionName)},Validator.prototype.picksToArray=function(picks,regionName){var rTestRegionPicks=null,regExpStr="",firstRoundLength=regionName===CONSTS.FINAL_ID?CONSTS.REGION_COUNT:CONSTS.TEAMS_PER_REGION,replacement="$"+_.range(1,firstRoundLength).join(",$"),seeds=regionName===CONSTS.FINAL_ID?CONSTS.REGION_IDS:this.firstRoundOrder,regExpJoiner=function(arr,reverse){var newArr=reverse?arr.reverse():arr;return"("+newArr.join("|")+"|"+CONSTS.UNPICKED_MATCH+")"},backref=function(i){return regExpJoiner.call(this,_.map(_.range(i,i+2),function(n){return"\\"+n}),!0)};if(regionName===CONSTS.FINAL_ID)regExpStr+=regExpJoiner.call(this,seeds.slice(0,CONSTS.REGION_COUNT)),regExpStr+=regExpJoiner.call(this,seeds.slice(0,CONSTS.REGION_COUNT)),regExpStr+=backref.call(this,1);else{for(var i=0;firstRoundLength>i;i+=2)regExpStr+=regExpJoiner.call(this,seeds.slice(i,i+2));for(i=1;firstRoundLength-2>i;i+=2)regExpStr+=backref.call(this,i)}return rTestRegionPicks=RegExp(regExpStr),rTestRegionPicks.test(picks)?this.wrapSuccess({picks:picks.replace(rTestRegionPicks,replacement).split(","),id:regionName}):this.wrapError("Unable to parse picks in region:",regionName)},Validator.prototype.validateFinal=function(finalPicks,validatedRounds){var semifinal=finalPicks.rounds[1];if(_.contains(semifinal,CONSTS.UNPICKED_MATCH))return this.wrapSuccess();for(var i=0,m=validatedRounds.length;m>i;i++)if(validatedRounds[i].id!==CONSTS.FINAL_ID&&_.last(validatedRounds[i].rounds)[0]===CONSTS.UNPICKED_MATCH)return this.wrapError("Final teams are selected without all regions finished");var playingItself=semifinal[0]===semifinal[1],playingWrongSide=this.data.regions[semifinal[0]].sameSideAs===semifinal[1];return _.subset(semifinal,CONSTS.REGION_IDS)?playingItself||playingWrongSide?this.wrapError("The championship game participants are from the same side of the bracket."):this.wrapSuccess():this.wrapError("The championship game participants are invalid.")},module.exports=Validator},{"../data/ncaa-mens-basketball/data":5,"../data/ncaa-mens-basketball/order":4,"../data/ncaa-mens-basketball/consts":6,"./quickCheck":8,lodash:7,async:9}],5:[function(require,module){var data={2012:{regions:["South","West","East","MidWest"],teams:{South:"Kentucky,Duke,Baylor,Indiana,Wichita St,UNLV,Notre Dame,Iowa St,UConn,Xavier,Colorado,VCU,New Mexico St,S Dakota St,Lehigh,Western Kentucky",West:"Mich St,Missouri,Marquette,Louisville,New Mexico,Murray St,Florida,Memphis,Saint Louis,Virginia,Colo St,L Beach St,Davidson,BYU,Norfolk St,LIU",East:"Syracuse,Ohio St,Florida St,Wisconsin,Vanderbilt,Cincy,Gonzaga,Kansas St,So Miss,W Virginia,Texas,Harvard,Montana,St B'nvntre,Loyola MD,UNC-Ash",MidWest:"UNC,Kansas,G'town,Michigan,Temple,SDSU,St Mary's,Creighton,Alabama,Purdue,NC State,USF,Ohio,Belmont,Detroit,UVM"}},2013:{regions:["MidWest","West","South","East"],teams:{MidWest:"Louisville,Duke,Michigan State,Saint Louis,Oklahoma State,Memphis,Creighton,Colorado State,Missouri,Cincinnati,Saint Mary's,Oregon,New Mexico State,Valparaiso,Albany,North Carolina A&T",West:"Gonzaga,Ohio State,New Mexico,Kansas State,Wisconsin,Arizona,Notre Dame,Pittsburgh,Wichita State,Iowa State,Belmont,Mississippi,Boise State/La Salle,Harvard,Iona,Southern",South:"Kansas,Georgetown,Florida,Michigan,VCU,UCLA,San Diego State,North Carolina,Villanova,Oklahoma,Minnesota,Akron,South Dakota State,Northwestern State,Florida Gulf Coast,Western Kentucky",East:"Indiana,Miami,Marquette,Syracuse,UNLV,Butler,Illinois,NC State,Temple,Colorado,Bucknell,California,Montana,Davidson,Pacific,James Madison/Long Island"}}},_=require("lodash"),finalData={FF:{name:"Final Four"}},currentYear=(new Date).getFullYear(),regionNameToId=function(name){return name.match(/[A-Z]/g).join("")};module.exports=function(options){options=options||{};var currentData=data[options.year]||data[currentYear]||data[currentYear-1]||data["2012"],exportData={regions:{}};return _.each(currentData.regions,function(region,index){exportData.regions[regionNameToId(region)]={name:region.charAt(0).toUpperCase()+region.slice(1).toLowerCase(),sameSideAs:regionNameToId(index%2?currentData.regions[index-1]:currentData.regions[index+1]),teams:currentData.teams[region].split(",")}}),_.extend(exportData,finalData),exportData}},{lodash:7}],6:[function(require,module){var data=require("./data")(),_=require("lodash"),noRegions=_.omit(data,"regions");module.exports={REGION_COUNT:_.keys(data.regions).length,REGION_IDS:_.keys(data.regions),FINAL_ID:_.keys(noRegions)[0],FINAL_NAME:noRegions[_.keys(noRegions)[0]].name,UNPICKED_MATCH:"X",TEAMS_PER_REGION:_.find(data.regions,function(){return!0}).teams.length}},{"./data":5,lodash:7}],10:[function(require,module){var process=module.exports={};process.nextTick=function(){var canSetImmediate="undefined"!=typeof window&&window.setImmediate,canPost="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(canSetImmediate)return function(f){return window.setImmediate(f)};if(canPost){var queue=[];return window.addEventListener("message",function(ev){if(ev.source===window&&"process-tick"===ev.data&&(ev.stopPropagation(),queue.length>0)){var fn=queue.shift();fn()}},!0),function(fn){queue.push(fn),window.postMessage("process-tick","*")}}return function(fn){setTimeout(fn,0)}}(),process.title="browser",process.browser=!0,process.env={},process.argv=[],process.binding=function(){throw Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(){throw Error("process.chdir is not supported")}},{}],9:[function(require,module){(function(process){(function(){function only_once(fn){var called=!1;return function(){if(called)throw Error("Callback was already called.");called=!0,fn.apply(root,arguments)}}var root,previous_async,async={};root=this,null!=root&&(previous_async=root.async),async.noConflict=function(){return root.async=previous_async,async};var _each=function(arr,iterator){if(arr.forEach)return arr.forEach(iterator);for(var i=0;arr.length>i;i+=1)iterator(arr[i],i,arr)},_map=function(arr,iterator){if(arr.map)return arr.map(iterator);var results=[];return _each(arr,function(x,i,a){results.push(iterator(x,i,a))}),results},_reduce=function(arr,iterator,memo){return arr.reduce?arr.reduce(iterator,memo):(_each(arr,function(x,i,a){memo=iterator(memo,x,i,a)}),memo)},_keys=function(obj){if(Object.keys)return Object.keys(obj);var keys=[];for(var k in obj)obj.hasOwnProperty(k)&&keys.push(k);return keys};async.nextTick=void 0!==process&&process.nextTick?process.nextTick:"function"==typeof setImmediate?function(fn){setImmediate(fn)}:function(fn){setTimeout(fn,0)},async.each=function(arr,iterator,callback){if(callback=callback||function(){},!arr.length)return callback();var completed=0;_each(arr,function(x){iterator(x,only_once(function(err){err?(callback(err),callback=function(){}):(completed+=1,completed>=arr.length&&callback(null))}))})},async.forEach=async.each,async.eachSeries=function(arr,iterator,callback){if(callback=callback||function(){},!arr.length)return callback();var completed=0,iterate=function(){var sync=!0;iterator(arr[completed],function(err){err?(callback(err),callback=function(){}):(completed+=1,completed>=arr.length?callback(null):sync?async.nextTick(iterate):iterate())}),sync=!1};iterate()},async.forEachSeries=async.eachSeries,async.eachLimit=function(arr,limit,iterator,callback){var fn=_eachLimit(limit);fn.apply(null,[arr,iterator,callback])},async.forEachLimit=async.eachLimit;var _eachLimit=function(limit){return function(arr,iterator,callback){if(callback=callback||function(){},!arr.length||0>=limit)return callback();var completed=0,started=0,running=0;(function replenish(){if(completed>=arr.length)return callback();for(;limit>running&&arr.length>started;)started+=1,running+=1,iterator(arr[started-1],function(err){err?(callback(err),callback=function(){}):(completed+=1,running-=1,completed>=arr.length?callback():replenish())})})()}},doParallel=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.each].concat(args))}},doParallelLimit=function(limit,fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[_eachLimit(limit)].concat(args))}},doSeries=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.eachSeries].concat(args))}},_asyncMap=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}}),eachfn(arr,function(x,callback){iterator(x.value,function(err,v){results[x.index]=v,callback(err)})},function(err){callback(err,results)})};async.map=doParallel(_asyncMap),async.mapSeries=doSeries(_asyncMap),async.mapLimit=function(arr,limit,iterator,callback){return _mapLimit(limit)(arr,iterator,callback)};var _mapLimit=function(limit){return doParallelLimit(limit,_asyncMap)};async.reduce=function(arr,memo,iterator,callback){async.eachSeries(arr,function(x,callback){iterator(memo,x,function(err,v){memo=v,callback(err)})},function(err){callback(err,memo)})},async.inject=async.reduce,async.foldl=async.reduce,async.reduceRight=function(arr,memo,iterator,callback){var reversed=_map(arr,function(x){return x}).reverse();async.reduce(reversed,memo,iterator,callback)},async.foldr=async.reduceRight;var _filter=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}}),eachfn(arr,function(x,callback){iterator(x.value,function(v){v&&results.push(x),callback()})},function(){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.filter=doParallel(_filter),async.filterSeries=doSeries(_filter),async.select=async.filter,async.selectSeries=async.filterSeries;var _reject=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}}),eachfn(arr,function(x,callback){iterator(x.value,function(v){v||results.push(x),callback()})},function(){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.reject=doParallel(_reject),async.rejectSeries=doSeries(_reject);var _detect=function(eachfn,arr,iterator,main_callback){eachfn(arr,function(x,callback){iterator(x,function(result){result?(main_callback(x),main_callback=function(){}):callback()})},function(){main_callback()})};async.detect=doParallel(_detect),async.detectSeries=doSeries(_detect),async.some=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){v&&(main_callback(!0),main_callback=function(){}),callback()})},function(){main_callback(!1)})},async.any=async.some,async.every=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){v||(main_callback(!1),main_callback=function(){}),callback()})},function(){main_callback(!0)})},async.all=async.every,async.sortBy=function(arr,iterator,callback){async.map(arr,function(x,callback){iterator(x,function(err,criteria){err?callback(err):callback(null,{value:x,criteria:criteria})})},function(err,results){if(err)return callback(err);var fn=function(left,right){var a=left.criteria,b=right.criteria;return b>a?-1:a>b?1:0};callback(null,_map(results.sort(fn),function(x){return x.value}))})},async.auto=function(tasks,callback){callback=callback||function(){};var keys=_keys(tasks);if(!keys.length)return callback(null);var results={},listeners=[],addListener=function(fn){listeners.unshift(fn)},removeListener=function(fn){for(var i=0;listeners.length>i;i+=1)if(listeners[i]===fn)return listeners.splice(i,1),void 0},taskComplete=function(){_each(listeners.slice(0),function(fn){fn()})};addListener(function(){_keys(results).length===keys.length&&(callback(null,results),callback=function(){})}),_each(keys,function(k){var task=tasks[k]instanceof Function?[tasks[k]]:tasks[k],taskCallback=function(err){var args=Array.prototype.slice.call(arguments,1);if(1>=args.length&&(args=args[0]),err){var safeResults={};_each(_keys(results),function(rkey){safeResults[rkey]=results[rkey]}),safeResults[k]=args,callback(err,safeResults),callback=function(){}}else results[k]=args,async.nextTick(taskComplete)},requires=task.slice(0,Math.abs(task.length-1))||[],ready=function(){return _reduce(requires,function(a,x){return a&&results.hasOwnProperty(x)},!0)&&!results.hasOwnProperty(k)};if(ready())task[task.length-1](taskCallback,results);else{var listener=function(){ready()&&(removeListener(listener),task[task.length-1](taskCallback,results))};addListener(listener)}})},async.waterfall=function(tasks,callback){if(callback=callback||function(){},!tasks.length)return callback();var wrapIterator=function(iterator){return function(err){if(err)callback.apply(null,arguments),callback=function(){};else{var args=Array.prototype.slice.call(arguments,1),next=iterator.next();next?args.push(wrapIterator(next)):args.push(callback),async.nextTick(function(){iterator.apply(null,args)})}}};wrapIterator(async.iterator(tasks))()};var _parallel=function(eachfn,tasks,callback){if(callback=callback||function(){},tasks.constructor===Array)eachfn.map(tasks,function(fn,callback){fn&&fn(function(err){var args=Array.prototype.slice.call(arguments,1);1>=args.length&&(args=args[0]),callback.call(null,err,args)})},callback);else{var results={};eachfn.each(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);1>=args.length&&(args=args[0]),results[k]=args,callback(err)})},function(err){callback(err,results)})}};async.parallel=function(tasks,callback){_parallel({map:async.map,each:async.each},tasks,callback)},async.parallelLimit=function(tasks,limit,callback){_parallel({map:_mapLimit(limit),each:_eachLimit(limit)},tasks,callback)},async.series=function(tasks,callback){if(callback=callback||function(){},tasks.constructor===Array)async.mapSeries(tasks,function(fn,callback){fn&&fn(function(err){var args=Array.prototype.slice.call(arguments,1);1>=args.length&&(args=args[0]),callback.call(null,err,args)
})},callback);else{var results={};async.eachSeries(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);1>=args.length&&(args=args[0]),results[k]=args,callback(err)})},function(err){callback(err,results)})}},async.iterator=function(tasks){var makeCallback=function(index){var fn=function(){return tasks.length&&tasks[index].apply(null,arguments),fn.next()};return fn.next=function(){return tasks.length-1>index?makeCallback(index+1):null},fn};return makeCallback(0)},async.apply=function(fn){var args=Array.prototype.slice.call(arguments,1);return function(){return fn.apply(null,args.concat(Array.prototype.slice.call(arguments)))}};var _concat=function(eachfn,arr,fn,callback){var r=[];eachfn(arr,function(x,cb){fn(x,function(err,y){r=r.concat(y||[]),cb(err)})},function(err){callback(err,r)})};async.concat=doParallel(_concat),async.concatSeries=doSeries(_concat),async.whilst=function(test,iterator,callback){if(test()){var sync=!0;iterator(function(err){return err?callback(err):(sync?async.nextTick(function(){async.whilst(test,iterator,callback)}):async.whilst(test,iterator,callback),void 0)}),sync=!1}else callback()},async.doWhilst=function(iterator,test,callback){var sync=!0;iterator(function(err){return err?callback(err):(test()?sync?async.nextTick(function(){async.doWhilst(iterator,test,callback)}):async.doWhilst(iterator,test,callback):callback(),void 0)}),sync=!1},async.until=function(test,iterator,callback){if(test())callback();else{var sync=!0;iterator(function(err){return err?callback(err):(sync?async.nextTick(function(){async.until(test,iterator,callback)}):async.until(test,iterator,callback),void 0)}),sync=!1}},async.doUntil=function(iterator,test,callback){var sync=!0;iterator(function(err){return err?callback(err):(test()?callback():sync?async.nextTick(function(){async.doUntil(iterator,test,callback)}):async.doUntil(iterator,test,callback),void 0)}),sync=!1},async.queue=function(worker,concurrency){function _insert(q,data,pos,callback){data.constructor!==Array&&(data=[data]),_each(data,function(task){var item={data:task,callback:"function"==typeof callback?callback:null};pos?q.tasks.unshift(item):q.tasks.push(item),q.saturated&&q.tasks.length===concurrency&&q.saturated(),async.nextTick(q.process)})}void 0===concurrency&&(concurrency=1);var workers=0,q={tasks:[],concurrency:concurrency,saturated:null,empty:null,drain:null,push:function(data,callback){_insert(q,data,!1,callback)},unshift:function(data,callback){_insert(q,data,!0,callback)},process:function(){if(q.concurrency>workers&&q.tasks.length){var task=q.tasks.shift();q.empty&&0===q.tasks.length&&q.empty(),workers+=1;var sync=!0,next=function(){workers-=1,task.callback&&task.callback.apply(task,arguments),q.drain&&0===q.tasks.length+workers&&q.drain(),q.process()},cb=only_once(function(){var cbArgs=arguments;sync?async.nextTick(function(){next.apply(null,cbArgs)}):next.apply(null,arguments)});worker(task.data,cb),sync=!1}},length:function(){return q.tasks.length},running:function(){return workers}};return q},async.cargo=function(worker,payload){var working=!1,tasks=[],cargo={tasks:tasks,payload:payload,saturated:null,empty:null,drain:null,push:function(data,callback){data.constructor!==Array&&(data=[data]),_each(data,function(task){tasks.push({data:task,callback:"function"==typeof callback?callback:null}),cargo.saturated&&tasks.length===payload&&cargo.saturated()}),async.nextTick(cargo.process)},process:function process(){if(!working){if(0===tasks.length)return cargo.drain&&cargo.drain(),void 0;var ts="number"==typeof payload?tasks.splice(0,payload):tasks.splice(0),ds=_map(ts,function(task){return task.data});cargo.empty&&cargo.empty(),working=!0,worker(ds,function(){working=!1;var args=arguments;_each(ts,function(data){data.callback&&data.callback.apply(null,args)}),process()})}},length:function(){return tasks.length},running:function(){return working}};return cargo};var _console_fn=function(name){return function(fn){var args=Array.prototype.slice.call(arguments,1);fn.apply(null,args.concat([function(err){var args=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(err?console.error&&console.error(err):console[name]&&_each(args,function(x){console[name](x)}))}]))}};async.log=_console_fn("log"),async.dir=_console_fn("dir"),async.memoize=function(fn,hasher){var memo={},queues={};hasher=hasher||function(x){return x};var memoized=function(){var args=Array.prototype.slice.call(arguments),callback=args.pop(),key=hasher.apply(null,args);key in memo?callback.apply(null,memo[key]):key in queues?queues[key].push(callback):(queues[key]=[callback],fn.apply(null,args.concat([function(){memo[key]=arguments;var q=queues[key];delete queues[key];for(var i=0,l=q.length;l>i;i++)q[i].apply(null,arguments)}])))};return memoized.memo=memo,memoized.unmemoized=fn,memoized},async.unmemoize=function(fn){return function(){return(fn.unmemoized||fn).apply(null,arguments)}},async.times=function(count,iterator,callback){for(var counter=[],i=0;count>i;i++)counter.push(i);return async.map(counter,iterator,callback)},async.timesSeries=function(count,iterator,callback){for(var counter=[],i=0;count>i;i++)counter.push(i);return async.mapSeries(counter,iterator,callback)},async.compose=function(){var fns=Array.prototype.reverse.call(arguments);return function(){var that=this,args=Array.prototype.slice.call(arguments),callback=args.pop();async.reduce(fns,args,function(newargs,fn,cb){fn.apply(that,newargs.concat([function(){var err=arguments[0],nextargs=Array.prototype.slice.call(arguments,1);cb(err,nextargs)}]))},function(err,results){callback.apply(that,[err].concat(results))})}},async.applyEach=function(fns){var go=function(){var that=this,args=Array.prototype.slice.call(arguments),callback=args.pop();return async.each(fns,function(fn,cb){fn.apply(that,args.concat([cb]))},callback)};if(arguments.length>1){var args=Array.prototype.slice.call(arguments,1);return go.apply(this,args)}return go},"undefined"!=typeof define&&define.amd?define([],function(){return async}):module!==void 0&&module.exports?module.exports=async:root.async=async})()})(require("__browserify_process"))},{__browserify_process:10}]},{},[1]);var app,BracketValidator=window.Bracket.Validator,BracketGenerator=window.Bracket.Generator,crazy=function(howFast){return setInterval(function(){app.navigate("#"+(new BracketGenerator).flatBracket(),{trigger:!0})},howFast)},BracketRouter=Backbone.Router.extend({routes:{"*bracket":"bracket"},initialize:function(){new BracketView,new SubNavView},bracket:function(bracket){if(bracket||!(window.location.href.indexOf("/user/")>-1)){("#"===bracket||"X"===bracket)&&(bracket="");var v=new BracketValidator({flatBracket:bracket,notEmpty:bracket?!0:!1});v.validate(function(err,res){err||$("#bracket").html(jade.render("regions",{regions:_.omit(res,"FF"),finalRegion:res.FF,live:!0}))});var href="https://twitter.com/intent/tweet?hashtags=tybrkt&via=tweetthebracket&url=";!bracket||bracket.indexOf("X")>-1?($("#tweet-button").addClass("disabled").removeClass("ready"),$("#tweet-button").attr("href","").click(function(){return!1})):($("#tweet-button").removeClass("disabled").addClass("ready"),$("#tweet-button").unbind().attr("href",href+encodeURIComponent(window.location.origin+"/"+window.location.hash)))}}}),SubNavView=Backbone.View.extend({el:".subnav",events:{"click a.random":"random"},random:function(e){e.preventDefault(),app.navigate("#"+(new BracketGenerator).flatBracket(),{trigger:!0})}}),BracketView=Backbone.View.extend({events:{"click a.game":"gameClick"},el:"#bracket",gameClick:function(e){e.preventDefault();var $target=$(e.target),$matchup=$target.parents(".matchup"),$thisRound=$matchup.parents(".round"),$thisRegion=$thisRound.parents(".bracket"),isFinal="FF"===$thisRegion.attr("id"),$nextRound=$thisRound.next(),$nextRounds=$thisRound.nextAll(),$winnerGoesTo=$nextRound.find("a").eq($matchup.index());isFinal?(isFinal&&$winnerGoesTo.data("from-region")&&$target.data("from-region")!==$winnerGoesTo.data("from-region")&&$nextRounds.find('[data-from-region="'+$winnerGoesTo.data("from-region")+'"]').replaceWith("<a>&nbsp;</a>"),$nextRound.length>0&&$nextRound.find("a").eq($matchup.index()).replaceWith($target.clone())):($winnerGoesTo.data("seed")&&$target.data("seed")!==$winnerGoesTo.data("seed")&&($nextRounds.find('[data-seed="'+$winnerGoesTo.data("seed")+'"]').replaceWith("<a>&nbsp;</a>"),this.$el.find(".bracket").last().find('[data-seed="'+$winnerGoesTo.data("seed")+'"][data-from-region="'+$winnerGoesTo.data("from-region")+'"]').replaceWith("<a>&nbsp;</a>")),$nextRound.length>0&&$nextRound.find("a").eq($matchup.index()).replaceWith($target.clone()),$nextRound.length!==$nextRounds.length||isFinal||this.$el.find(".bracket").last().find("a").eq($thisRegion.index()).replaceWith($target.clone()));var bc=this.getBracketCode();app.navigate("#"+bc,{trigger:!1});var href="https://twitter.com/intent/tweet?hashtags=tybrkt&via=tweetthebracket&url=";return!bc||bc.indexOf("X")>-1?($("#tweet-button").addClass("disabled").removeClass("ready"),$("#tweet-button").attr("href","").click(function(){return!1})):($("#tweet-button").removeClass("disabled").addClass("ready"),$("#tweet-button").unbind().attr("href",href+encodeURIComponent(window.location.href))),!1},getBracketCode:function(){return _.map(this.$el.find(".bracket"),function(item){return this.getRegionCode(item.id)},this).join("")},getRegionCode:function(regionId){var $region=this.$el.find("#"+regionId);return regionId+_.map($region.find(".round:gt(0) a"),function(item){return("FF"===regionId?$(item).data("from-region"):$(item).data("seed"))||"X"}).join("")}});(function($){$(function(){function processScroll(){var scrollTop=$win.scrollTop();scrollTop>=subnavTop&&!isFixed?(isFixed=1,$nav.addClass("subnav-fixed"),$body.addClass("has-subnav-fixed")):subnavTop>=scrollTop&&isFixed&&(isFixed=0,$nav.removeClass("subnav-fixed"),$body.removeClass("has-subnav-fixed"))}app=new BracketRouter,Backbone.history.start({pushState:!1}),$("form.navbar-search").submit(function(e){e.preventDefault();var username=$(this).find("input").val();username&&(window.location.href="/user/"+username)}),$(".subnav a.scroll").smoothScroll();var $win=$(window),$body=$("body"),$nav=$(".subnav"),navHeight=$(".navbar").first().height(),subnavTop=$(".subnav").length&&$(".subnav").offset().top-navHeight,isFixed=0;$(".subnav").length>0&&(processScroll(),$win.on("scroll",processScroll))})})(window.jQuery);